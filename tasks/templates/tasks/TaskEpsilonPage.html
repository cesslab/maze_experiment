{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    Task {{task_number}}
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'tasks/task2.css' %}">
{% endblock %}

{% block content %}
    <div>
      <p>
      Task {{ task_number }} again is again similar to tasks 1 and 2 except that here you have lotteries on the left and
        the right with identical known probabilities defined over different prizes. As you move down the table from row
      1 to row 11 the probability of getting the big prize increases in an identical manner for each left-side and
        right-side lottery. For each row you will need to decide if you prefer the option on the right or the one on
        the left.
      <p>
      <p>
        As you look down the columns of lottery options you will see that the probability associated with winning the
        big prize (either $2.00 for lottery option A or $3.85 for lottery option B)
        systematically decreases while that of winning the  prize increases. Your task is to find that row in the
        table such that for all options above that row you prefer to select, say, the lottery option A to the lottery option B but
        after all rows below you prefer the lottery option B. By clicking that row you will execute your choice.
      </p>
      <p>
        For example, say that for cases 1, 2, and 3 you prefer the lottery option B to the lottery option A, but for cases (rows)
        4 to 11 you prefer the lottery option A. If you click the lottery option B option in case 3, then the computer will fill the table for
        you and designate a choice of lottery option B over lottery option A for cases (rows) 1 to 3 and lottery option A over lottery option B for cases (rows)
        4 to 11 . If you click the lottery option A in row 7, then that will mean that you prefer the lottery option A to the lottery option B
        for cases (rows) 1 to 7 but the lottery option B over the lottery option A for cases (rows) 8 to 11. If you always want the lottery option A,
        then click the lottery option A in row 11 and all choices above that will designate the lottery option A over the lottery option B. If
        you always prefer the lottery option B, click that option in row 11. To change your choice just click on an option
        in a different row.
      </p>
    </div>
    <div>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th style="text-align: center;">Case</th>
                <th>Lottery Option A</th>
                <th>Lottery Option B</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>1</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_1">
                        {{ cases.0.option_a.prob_high }}% probability you win {{ cases.0.option_a.payoff_high|c }} and
                        {{ cases.0.option_a.prob_low }}% probability you win {{ cases.0.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" class="maze" data-type="maze" value="1" data-task="a" data-case="1"  id="a_maze_1" name="task_epsilon_1" autocomplete="off">
                </td>
                <td>
                    <input type="radio" class="lottery" data-type="lottery" value="2" data-task="a" data-case="1"  id="a_lottery_1" name="task_epsilon_1" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_1">
                        {{ cases.0.option_b.prob_high }}% probability you win {{ cases.0.option_b.payoff_high|c }} and
                        {{ cases.0.option_b.prob_low }}% probability you win {{ cases.0.option_b.payoff_low|c }}
                    </label>
                </td>
            <tr>
                <td>2</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_2">
                        {{ cases.1.option_a.prob_high }}% probability you win {{ cases.1.option_a.payoff_high|c }} and
                        {{ cases.1.option_a.prob_low }}% probability you win {{ cases.1.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" class="maze" data-type="maze" value="1" data-task="a" data-case="2" id="a_maze_2" name="task_epsilon_2" autocomplete="off">
                </td>
                <td>
                    <input type="radio" class="lottery" data-type="lottery" value="2" data-task="a" data-case="2" id="a_lottery_2" name="task_epsilon_2" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_2">
                        {{ cases.1.option_b.prob_high }}% probability you win {{ cases.1.option_b.payoff_high|c }} and
                        {{ cases.1.option_b.prob_low }}% probability you win {{ cases.1.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>3</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_3">
                        {{ cases.2.option_a.prob_high }}% probability you win {{ cases.2.option_a.payoff_high|c }} and
                        {{ cases.2.option_a.prob_low }}% probability you win {{ cases.2.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="3"  id="a_maze_3" name="task_epsilon_3" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="3"  id="a_lottery_3" name="task_epsilon_3" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_3">
                        {{ cases.2.option_b.prob_high }}% probability you win {{ cases.2.option_b.payoff_high|c }} and
                        {{ cases.2.option_b.prob_low }}% probability you win {{ cases.2.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>4</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_4">
                        {{ cases.3.option_a.prob_high }}% probability you win {{ cases.3.option_a.payoff_high|c }} and
                        {{ cases.3.option_a.prob_low }}% probability you win {{ cases.3.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="4" id="a_maze_4" name="task_epsilon_4" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="4" id="a_lottery_4" name="task_epsilon_4" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_4">
                        {{ cases.3.option_b.prob_high }}% probability you win {{ cases.3.option_b.payoff_high|c }} and
                        {{ cases.3.option_b.prob_low }}% probability you win {{ cases.3.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>5</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_5">
                        {{ cases.4.option_a.prob_high }}% probability you win {{ cases.4.option_a.payoff_high|c }} and
                        {{ cases.4.option_a.prob_low }}% probability you win {{ cases.4.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="5" id="a_maze_5" name="task_epsilon_5" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="5" id="a_lottery_5" name="task_epsilon_5" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_5">
                        {{ cases.4.option_b.prob_high }}% probability you win {{ cases.4.option_b.payoff_high|c }} and
                        {{ cases.4.option_b.prob_low }}% probability you win {{ cases.4.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>6</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_6">
                        {{ cases.5.option_a.prob_high }}% probability you win {{ cases.5.option_a.payoff_high|c }} and
                        {{ cases.5.option_a.prob_low }}% probability you win {{ cases.5.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="6" id="a_maze_6" name="task_epsilon_6" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="6"  id="a_lottery_6" name="task_epsilon_6" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_6">
                        {{ cases.5.option_b.prob_high }}% probability you win {{ cases.5.option_b.payoff_high|c }} and
                        {{ cases.5.option_b.prob_low }}% probability you win {{ cases.5.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>7</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_7">
                        {{ cases.6.option_a.prob_high }}% probability you win {{ cases.6.option_a.payoff_high|c }} and
                        {{ cases.6.option_a.prob_low }}% probability you win {{ cases.6.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="7" id="a_maze_7" name="task_epsilon_7" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="7" id="a_lottery_7" name="task_epsilon_7" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_7">
                        {{ cases.6.option_b.prob_high }}% probability you win {{ cases.6.option_b.payoff_high|c }} and
                        {{ cases.6.option_b.prob_low }}% probability you win {{ cases.6.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>8</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_8">
                        {{ cases.7.option_a.prob_high }}% probability you win {{ cases.7.option_a.payoff_high|c }} and
                        {{ cases.7.option_a.prob_low }}% probability you win {{ cases.7.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="8" id="a_maze_8" name="task_epsilon_8" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="8"  id="a_lottery_8" name="task_epsilon_8" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_8">
                        {{ cases.7.option_b.prob_high }}% probability you win {{ cases.7.option_b.payoff_high|c }} and
                        {{ cases.7.option_b.prob_low }}% probability you win {{ cases.7.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>9</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_9">
                        {{ cases.8.option_a.prob_high }}% probability you win {{ cases.8.option_a.payoff_high|c }} and
                        {{ cases.8.option_a.prob_low }}% probability you win {{ cases.8.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="9" id="a_maze_9" name="task_epsilon_9" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="9" id="a_lottery_9" name="task_epsilon_9" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_9">
                        {{ cases.8.option_b.prob_high }}% probability you win {{ cases.8.option_b.payoff_high|c }} and
                        {{ cases.8.option_b.prob_low }}% probability you win {{ cases.8.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            <tr>
                <td>10</td>
                <td>
                    <label style="margin-right: 5px;" for="a_maze_10">
                        {{ cases.9.option_a.prob_high }}% probability you win {{ cases.9.option_a.payoff_high|c }} and
                        {{ cases.9.option_a.prob_low }}% probability you win {{ cases.9.option_a.payoff_low|c }}
                    </label>
                    <input type="radio" value="1" class="maze" data-type="maze" data-task="a" data-case="10" id="a_maze_10" name="task_epsilon_10" autocomplete="off">
                </td>
                <td>
                    <input type="radio" value="2" class="lottery" data-type="lottery" data-task="a" data-case="10" id="a_lottery_10" name="task_epsilon_10" autocomplete="off">
                    <label style="margin-left: 5px;" for="a_lottery_10">
                        {{ cases.9.option_b.prob_high }}% probability you win {{ cases.9.option_b.payoff_high|c }} and
                        {{ cases.9.option_b.prob_low }}% probability you win {{ cases.9.option_b.payoff_low|c }}
                    </label>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <p>
        <button id="task-next-button" class="otree-btn-next btn btn-primary">Next</button>
    </p>

{% endblock %}
{% block scripts %}
    <script>
        $(document).ready(function() {
            $('input[type=radio]').click(function(e) {
                let caseNumber = parseInt(e.target.dataset.case);
                let task = e.target.dataset.task;
                let selectedOptionType = e.target.dataset.type;
                let otherOptionType = (e.target.dataset.type === "maze") ? "lottery" : "maze";

                console.log(typeof(selectedOptionType));

                let sameColumn = Array.from(document.querySelectorAll(`[data-task='${task}'][data-type='${selectedOptionType}']`));
                let otherColumn = Array.from(document.querySelectorAll(`[data-task='${task}'][data-type='${otherOptionType}']`));
                for (let i = 0; i < sameColumn.length; ++i) {
                    if (parseInt(sameColumn[i].dataset.case) <= caseNumber) {
                        sameColumn[i].checked = true;
                        otherColumn[i].checked = false;
                    }
                    else {
                        otherColumn[i].checked = true;
                        sameColumn[i].checked = false;
                    }
                }
            })

        });
    </script>
{% endblock %}
